<!--begin::Post-->
<div class="post d-flex flex-column-fluid" id="kt_post">
    <!--begin::Container-->
    <div id="kt_content_container" class="container">
        <!--begin::Basic info-->
        <div class="card mb-5 mb-xl-10">
            <!--begin::Card header-->
            <div class="card-header border-0 cursor-pointer" role="button" data-bs-toggle="collapse"
                data-bs-target="#kt_account_profile_details" aria-expanded="true"
                aria-controls="kt_account_profile_details">
                <!--begin::Card title-->
                <div class="card-title m-0">
                    <h3 class="fw-bolder m-0">Deposits</h3>
                </div>
                <!--end::Card title-->
                <!--begin::Card Toolbar-->
                <div class="card-toolbar">
                    <div class="d-flex justify-content-end" data-kt-blacklist-table-toolbar="base">
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                            data-bs-target="#kt_modal_add_deposit">
                            <!--begin::Svg Icon | path: icons/duotone/Navigation/Plus.svg-->
                            <span class="svg-icon svg-icon-2">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <rect fill="#000000" x="4" y="11" width="16" height="2" rx="1" />
                                    <rect fill="#000000" opacity="0.5"
                                        transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000)"
                                        x="4" y="11" width="16" height="2" rx="1" />
                                </svg>
                            </span>
                            <!--end::Svg Icon-->
                            {{ "Add Deposit" | translate }}
                        </button>
                    </div>
                </div>
            </div>
            <!--begin::Card header-->
            <!--begin::Content-->
            <div id="kt_account_profile_details" class="collapse show">
                <div class="post d-flex flex-column-fluid" id="kt_post">
                    <!--begin::Container-->
                    <div id="kt_content_container" class="container">
                        <!--begin::Card-->
                        <div class="card">
                            <!--begin::Card body-->
                            <div class="card-body pt-0">
                                <!--begin::Table-->
                                <table mat-table matSort (matSortChange)="sortData($event)"
                                    class="table align-middle table-row-dashed fs-6 gy-5" id="kt_table_templates">
                                    <!--begin::Table head-->
                                    <thead>
                                        <!--begin::Table row-->
                                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                            <th>id</th>
                                            <th mat-sort-header="username"> {{ "User" | translate }}</th>
                                            <th mat-sort-header="auction_id"> {{ "Auction" | translate }}</th>
                                            <th mat-sort-header="amount"> {{ "Amount" | translate }}</th>
                                            <th mat-sort-header="status"> {{ "Status" | translate }}</th>
                                            <th mat-sort-header="note"> {{ "Note" | translate }}</th>
                                            <th mat-sort-header="create_date"> {{ "Create Date" | translate }}</th>
                                            <!-- <th class="text-end">Actions</th> -->
                                        </tr>
                                        <!--end::Table row-->
                                    </thead>
                                    <!--end::Table head-->
                                    <!--begin::Table body-->
                                    <tbody class="text-gray-600 fw-bold">
                                        <!--begin::Table row-->
                                        <tr *ngFor="let deposit of deposits; let i = index;">
                                            <td> {{ (i+1) }} </td>
                                            <td><a [routerLink]="['/user-details']" [queryParams]="{ id: deposit.user.id }">{{
                                                    deposit.user | userName }}</a></td>
                                            <td><a [routerLink]="['/auctions']"
                                                    [queryParams]="{ id: deposit.auction.id }">{{
                                                    deposit.auction.title.en
                                                    }}</a></td>
                                            <td>{{ deposit.amount | currency:'OMR'}}</td>
                                            <td>
                                                <div class="badge badge-light-success fw-bolder">{{deposit.status |
                                                    titlecase}}
                                                </div>
                                            </td>
                                            <td>
                                                <a data-bs-toggle="modal" data-bs-target="#kt_modal_note_details"
                                                    class="btn btn-bg-light btn-sm">
                                                    Details
                                                </a>
                                                <div class="modal fade" id="kt_modal_note_details" tabindex="-1"
                                                    aria-hidden="true">
                                                    <!--begin::Modal dialog-->
                                                    <div class="modal-dialog modal-dialog-centered mw-650px">
                                                        <!--begin::Modal content-->
                                                        <div class="modal-content">
                                                            <!--begin::Modal header-->
                                                            <div class="modal-header" id="kt_modal_note_details_header">
                                                                <!--begin::Modal title-->
                                                                <h2 class="fw-bolder"> {{ "Deposit Note Details" |
                                                                    translate }}</h2>
                                                                <!--end::Modal title-->
                                                                <!--begin::Close-->
                                                                <div class="btn btn-icon btn-sm btn-active-icon-primary"
                                                                    data-bs-dismiss="modal">
                                                                    <!--begin::Svg Icon | path: icons/duotone/Navigation/Close.svg-->
                                                                    <span class="svg-icon svg-icon-1">
                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                            xmlns:xlink="http://www.w3.org/1999/xlink"
                                                                            width="24px" height="24px"
                                                                            viewBox="0 0 24 24" version="1.1">
                                                                            <g transform="translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)"
                                                                                fill="#000000">
                                                                                <rect fill="#000000" x="0" y="7"
                                                                                    width="16" height="2" rx="1" />
                                                                                <rect fill="#000000" opacity="0.5"
                                                                                    transform="translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)"
                                                                                    x="0" y="7" width="16" height="2"
                                                                                    rx="1" />
                                                                            </g>
                                                                        </svg>
                                                                    </span>
                                                                    <!--end::Svg Icon-->
                                                                </div>
                                                                <!--end::Close-->
                                                            </div>
                                                            <!--end::Modal header-->
                                                            <!--begin::Modal body-->
                                                            <div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
                                                                <!--begin::Form-->
                                                                <form id="kt_modal_add_blacklist_form" class="form"
                                                                    action="#">
                                                                    <!--begin::Scroll-->
                                                                    <div class="d-flex flex-column scroll-y me-n7 pe-7"
                                                                        id="kt_modal_add_blacklist_scroll"
                                                                        data-kt-scroll="true"
                                                                        data-kt-scroll-activate="{default: false, lg: true}"
                                                                        data-kt-scroll-max-height="auto"
                                                                        data-kt-scroll-dependencies="#kt_modal_add_blacklist_header"
                                                                        data-kt-scroll-wrappers="#kt_modal_add_blacklist_scroll"
                                                                        data-kt-scroll-offset="300px">
                                                                        <!--begin::Input group-->
                                                                        <div class="fv-row mb-7">
                                                                            <span
                                                                                [innerHTML]="deposit.note | nl2br"></span>
                                                                        </div>
                                                                        <!--end::Input group-->
                                                                    </div>
                                                                    <!--end::Scroll-->
                                                                    <!--begin::Actions-->
                                                                    <div class="text-center pt-15">
                                                                        <button type="reset" class="btn btn-white me-3"
                                                                            data-bs-dismiss="modal">Discard</button>
                                                                    </div>
                                                                    <!--end::Actions-->
                                                                </form>
                                                                <!--end::Form-->
                                                            </div>
                                                            <!--end::Modal body-->
                                                        </div>
                                                        <!--end::Modal content-->
                                                    </div>
                                                    <!--end::Modal dialog-->
                                                </div>
                                            </td>
                                            <td>{{ deposit.create_date | date:"short"}}</td>

                                            <!--begin::Action=-->
                                            <!-- <td class="text-end">
                                                <a class="btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1">
                                                    <!--begin::Svg Icon | path: icons/duotone/Communication/Write.svg--
                                                    <span class="svg-icon svg-icon-3">
                                                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                                            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                                <rect x="0" y="0" width="24" height="24"/>
                                                                <path d="M8,13.1668961 L20.4470385,11.9999863 L8,10.8330764 L8,5.77181995 C8,5.70108058 8.01501031,5.63114635 8.04403925,5.56663761 C8.15735832,5.31481744 8.45336217,5.20254012 8.70518234,5.31585919 L22.545552,11.5440255 C22.6569791,11.5941677 22.7461882,11.6833768 22.7963304,11.794804 C22.9096495,12.0466241 22.7973722,12.342628 22.545552,12.455947 L8.70518234,18.6841134 C8.64067359,18.7131423 8.57073936,18.7281526 8.5,18.7281526 C8.22385763,18.7281526 8,18.504295 8,18.2281526 L8,13.1668961 Z" fill="#000000"/>
                                                                <path d="M4,16 L5,16 C5.55228475,16 6,16.4477153 6,17 C6,17.5522847 5.55228475,18 5,18 L4,18 C3.44771525,18 3,17.5522847 3,17 C3,16.4477153 3.44771525,16 4,16 Z M1,11 L5,11 C5.55228475,11 6,11.4477153 6,12 C6,12.5522847 5.55228475,13 5,13 L1,13 C0.44771525,13 6.76353751e-17,12.5522847 0,12 C-6.76353751e-17,11.4477153 0.44771525,11 1,11 Z M4,6 L5,6 C5.55228475,6 6,6.44771525 6,7 C6,7.55228475 5.55228475,8 5,8 L4,8 C3.44771525,8 3,7.55228475 3,7 C3,6.44771525 3.44771525,6 4,6 Z" fill="#000000" opacity="0.3"/>
                                                            </g>
                                                        </svg>
                                                    </span>
                                                    <!--end::Svg Icon--
                                                </a>
                                                <a class="btn btn-icon btn-bg-light btn-active-color-primary btn-sm">
                                                    <!--begin::Svg Icon | path: icons/duotone/General/Trash.svg--
                                                    <span class="svg-icon svg-icon-3">
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            xmlns:xlink="http://www.w3.org/1999/xlink" width="24px"
                                                            height="24px" viewBox="0 0 24 24" version="1.1">
                                                            <g stroke="none" stroke-width="1" fill="none"
                                                                fill-rule="evenodd">
                                                                <rect x="0" y="0" width="24" height="24"></rect>
                                                                <path
                                                                    d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z"
                                                                    fill="#000000" fill-rule="nonzero"></path>
                                                                <path
                                                                    d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z"
                                                                    fill="#000000" opacity="0.3"></path>
                                                            </g>
                                                        </svg>
                                                    </span>
                                                    <!--end::Svg Icon--
                                                </a>
                                            </td> -->
                                            <!--end::Action=-->
                                        </tr>
                                        <!--end::Table row-->
                                    </tbody>
                                    <!--end::Table body-->
                                </table>
                                <!--end::Table-->
                                <div class="has-text-centered">
                                    <div class="spinner" [ngClass]="{ 'hidden': !utility.loader }"></div>
                                    <mat-paginator #paginator showFirstLastButtons [length]="filter_config.totalItems"
                                        [pageSize]="filter_config.itemsPerPage"
                                        [pageSizeOptions]="filter_config.pageSizeOptions"
                                        (page)="pageChangeEvent($event)">
                                    </mat-paginator>
                                </div>
                            </div>
                            <!--end::Card body-->
                        </div>
                        <!--end::Card-->
                    </div>
                </div>
            </div>
            <div class="modal fade" id="kt_modal_add_deposit" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-750px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bolder">{{ "Add Deposit" | translate }}</h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div class="btn btn-icon btn-sm btn-active-icon-primary" data-bs-dismiss="modal">
                                <!--begin::Svg Icon | path: icons/duotone/Navigation/Close.svg-->
                                <span class="svg-icon svg-icon-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                        <g transform="translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)"
                                            fill="#000000">
                                            <rect fill="#000000" x="0" y="7" width="16" height="2" rx="1" />
                                            <rect fill="#000000" opacity="0.5"
                                                transform="translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)"
                                                x="0" y="7" width="16" height="2" rx="1" />
                                        </g>
                                    </svg>
                                </span>
                                <!--end::Svg Icon-->
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body scroll-y mx-lg-5 my-7">
                            <!--begin::Scroll-->
                            <div class="d-flex flex-column scroll-y me-n7 pe-7" id="kt_modal_add_deposit_scroll"
                                data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}"
                                data-kt-scroll-max-height="auto"
                                data-kt-scroll-dependencies="#kt_modal_add_deposit_header"
                                data-kt-scroll-wrappers="#kt_modal_add_deposit_scroll" data-kt-scroll-offset="300px">
                                <div class="fv-row mb-10">
                                    <!--begin::Label-->
                                    <label class="required fw-bold fs-6 mb-2">{{ "User" | translate }}</label>
                                    <!--end::Label-->
                                    <input class="form-control header-color" [(ngModel)]="user_param"
                                        (keyup)="onChangeUser()" placeholder="type to serach user ...">
                                    <select name="user_id" class="form-select form-select-lg form-select-solid mt-3"
                                        [(ngModel)]="deposit.user_id">
                                        <option *ngFor="let user of users" [ngValue]='user.id'>{{ user.contact }}
                                        </option>
                                    </select>
                                </div>
                                <div class="fv-row mb-10">
                                    <label class="fs-5 fw-bolder form-label mb-2">
                                        <span>Auction</span>
                                    </label>
                                    <select name="auction_id" class="form-select form-select-lg form-select-solid"
                                        [(ngModel)]="deposit.auction_id">
                                        <option *ngFor="let auction of auctions" [ngValue]='auction.id'>
                                            {{ auction.code
                                            }}</option>
                                    </select>
                                </div>
                                <div class="fv-row mb-10">
                                    <label class="fs-5 fw-bolder form-label mb-2">
                                        <span class="required">{{ "Amount" | translate }}</span>
                                    </label>
                                    <input type="number" name="amount"
                                        class="form-control form-control-solid mb-3 mb-lg-0"
                                        [(ngModel)]="deposit.amount" />
                                </div>
                            </div>
                            <!--end::Scroll-->
                            <!--begin::Actions-->
                            <div class="text-center pt-15">
                                <button type="reset" class="btn btn-white me-3" data-bs-dismiss="modal">Discard</button>
                                <button type="submit" class="btn btn-primary" (click)="onSubmit()"
                                    data-kt-roles-modal-action="submit">
                                    <span class="indicator-label">{{ "Submit" | translate }}</span>
                                    <span class="indicator-progress">Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
                                </button>
                            </div>
                            <!--end::Actions-->
                        </div>
                        <!--end::Modal body-->
                    </div>
                    <!--end::Modal content-->
                </div>
                <!--end::Modal dialog-->
            </div>
            <!--end::Modal - Add fields-->
            <div *ngIf="errorMessage" class="swal2-container swal2-center swal2-backdrop-show"
                style="overflow-y: auto;">
                <div aria-labelledby="swal2-title" aria-describedby="swal2-content"
                    class="swal2-popup swal2-modal swal2-icon-error swal2-show" tabindex="-1" role="dialog"
                    aria-live="assertive" aria-modal="true" style="display: flex;">
                    <div class="swal2-header">
                        <div class="swal2-icon swal2-error swal2-icon-show" style="display: flex;"><span
                                class="swal2-x-mark">
                                <span class="swal2-x-mark-line-left"></span>
                                <span class="swal2-x-mark-line-right"></span>
                            </span>
                        </div><img class="swal2-image" style="display: none;">
                        <h2 class="swal2-title" id="swal2-title" style="display: none;"></h2><button type="button"
                            class="swal2-close" aria-label="Close this dialog" style="display: none;">×</button>
                    </div>
                    <div class="swal2-content">
                        <div id="swal2-content" class="swal2-html-container" style="display: block;">
                            Sorry, looks like there
                            are some errors detected, please try again.</div>
                    </div>
                    <div class="swal2-actions">
                        <div class="swal2-loader"></div>
                        <button type="button" class="swal2-confirm btn btn-light" style="display: inline-block;"
                            (click)="errorMessage=false">Ok, got
                            it!</button>
                    </div>
                </div>
            </div>
            <div *ngIf="successMessage" class="swal2-container swal2-center swal2-backdrop-show"
                style="overflow-y: auto;">
                <div aria-labelledby="swal2-title" aria-describedby="swal2-content"
                    class="swal2-popup swal2-modal swal2-icon-success swal2-show" tabindex="-1" role="dialog"
                    aria-live="assertive" aria-modal="true" style="display: flex;">
                    <div class="swal2-header">
                        <div class="swal2-icon swal2-success swal2-icon-show" style="display: flex;">
                            <div class="swal2-success-circular-line-left" style="background-color: rgb(255, 255, 255);">
                            </div>
                            <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
                            <div class="swal2-success-ring"></div>
                            <div class="swal2-success-fix" style="background-color: rgb(255, 255, 255);"></div>
                            <div class="swal2-success-circular-line-right"
                                style="background-color: rgb(255, 255, 255);">
                            </div>
                        </div><img class="swal2-image" style="display: none;">
                        <h2 class="swal2-title" id="swal2-title" style="display: none;"></h2><button type="button"
                            class="swal2-close" aria-label="Close this dialog" style="display: none;">×</button>
                    </div>
                    <div class="swal2-content">
                        <div id="swal2-content" class="swal2-html-container" style="display: block;">
                            Request has been
                            successfully submitted!</div>
                    </div>
                    <div class="swal2-actions">
                        <div class="swal2-loader"></div><button type="button" class="swal2-confirm btn btn-primary"
                            (click)="successMessage=false" style="display: inline-block;">{{ "Ok" | translate
                            }}</button>
                    </div>
                </div>
            </div>
            <!--end::Content-->
        </div>
        <!--end::Basic info-->
    </div>
    <!--end::Container-->
</div>
<!-- spinnner element is defined with id loading -->
<div *ngIf="this.utility.loader" class="loading"></div>